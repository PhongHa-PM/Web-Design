<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <title>Vivu 24h Camping</title>
  <!-- Font Awesome Boxicon Cdn -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Custom CSS -->
  <link rel="stylesheet" href="./css/admin.css">
</head>

<body>
  <nav class="navbar navbar-expand-lg fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="./Admin-AdminHome.html" id="logo"><img class="img-logo" src="/img/logo.jpg" alt="">
        <a class="navbar-brand" href="./Admin-AdminHome.html">Admin</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar"
          aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Admin</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
              <div class="offcanvas-body">
                <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                  <li class="nav-item dropdown d-block ">
                    <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button"
                      data-bs-toggle="dropdown" aria-expanded="false">
                      <i class='bx bx-bell'></i>
                      <p class="bell item-text ms-2 m-0">Thông báo</p>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                      <li>
                        <a class="dropdown-item" href="#">
                          <i class='bx bxs-user-circle icon'></i>
                          <div class="content">
                            <div class="name-text-wrapper">
                              <span class="name">Toàn Châu</span>
                              <span class="text">Vừa thay đổi thông tin đơn hàng tù Hồ </span>
                            </div>
                            <div class="time">1 giờ 45 phút trước</div>
                          </div>
                        </a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">
                          <i class='bx bxs-user-circle icon'></i>
                          <div class="content">
                            <div class="name-text-wrapper">
                              <span class="name">Hà Huy Phong</span>
                              <span class="text">Đã đặt tuor Hồ Trị An</span>
                            </div>
                            <div class="time">2 giờ trước</div>
                          </div>
                        </a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">
                          <i class='bx bxs-user-circle icon'></i>
                          <div class="content">
                            <div class="name-text-wrapper">
                              <span class="name">Phạm Minh Tuấn</span>
                              <span class="text">Thanh toán qua ApplePay</span>
                            </div>
                            <div class="time">3 giờ 10 phút trước</div>
                          </div>
                        </a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">
                          <i class='bx bxs-user-circle icon'></i>
                          <div class="content">
                            <div class="name-text-wrapper">
                              <span class="name">Jack Any</span>
                              <span class="text">Yêu cầu thay đổi thông tin đơn hàng </span>
                            </div>
                            <div class="time">7 giờ trước</div>
                          </div>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="nav-item dropdown d-block">
                    <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button"
                      data-bs-toggle="dropdown" aria-expanded="false">
                      <i class='bx bx-message-rounded-dots'></i>
                      <p class=" mess item-text m-0">Tin nhắn</p>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-left">
                      <li>
                        <a class="dropdown-item" href="#">
                          <i class='bx bxs-user-circle icon mt-0'></i>
                          <div class="info">
                            <p class="name m-0">Toàn Châu</p>
                            <p class="text m-0">Bạn: Mình xin được trả lời bạn như sau </p>
                            <p class="time mt-0">1 phút trước</p>
                          </div>
                        </a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">
                          <i class='bx bxs-user-circle icon mt-0'></i>
                          <div class="info m-0">
                            <p class="name m-0">Jack Any</p>
                            <p class="text m-0">Jack: Shop cho em hỏi, tour đi Trị An</p>
                            <p class="time m-0">1 phút trước</p>
                          </div>
                        </a>
                      </li>
                    </ul>
                  </li>

                  <li class="sidebar-out nav-item"><a class="nav-link" href="/User-index.html"><i
                        class='bx bx-home'></i><span class="item-text ms-2">Trang Chính</span></a></li>
                  <li class="sidebar-out nav-item"><a class="nav-link" href="./Admin-Addproduct.html"><i
                        class='bx bx-book-bookmark'></i><span class="item-text ms-2">Quản lí sản
                        phẩm</span></a></li>
                  <li class="sidebar-out nav-item"><a class="nav-link" href="#"><i class='bx bx-history'></i><span
                        class="item-text ms-2">Lịch sử</span></a></li>
                  <li class="sidebar-out nav-item"><a class="nav-link" href="./Admin-Feedback.html"><i
                        class='bx bx-bar-chart'></i><span class="item-text ms-2">Đánh giá</span></a></li>
                  <li class="nav-item dropdown d-block ">
                    <a class="nav-link dropdown-toggle d-flex justify-content-center align-items-center" href="#"
                      role="button" data-bs-toggle="dropdown" aria-expanded="false">
                      <i class='bx bxs-user-circle'></i>
                      <p class="ms-2 m-0">Phạm Minh Tuấn</p>
                    </a>
                    <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="#"><i class='bx bx-info-circle'
                            style="margin-right: 5px;"></i>Thông
                          Tin</a></li>
                      <li><a class="dropdown-item" href="#"><i class='bx bx-cog' style="margin-right: 5px;"></i>Cài
                          Đặt</a>
                      </li>
                      <li>
                        <hr class="dropdown-divider">
                      </li>
                      <li><a class="dropdown-item active-dr" style="color: red; background: none;"
                          href="./Admin-Login.html"><i class='bx bx-log-out' style="margin-right: 5px;"></i>Đăng
                          Xuất</a></li>
                    </ul>
                  </li>
                </ul>
              </div>
          </div>
        </div>
  </nav>
  <section class="Admin container-fluid mt-5 pt-3 ">
    <div class="col-md-3 col-lg-3 mt-5 sidebar p-3">
      <button id="toggle-btn" class="btn btn-secondary"><i class="fas fa-bars"></i></button>
      <ul class="list-unstyled">
        <li><a href="/User-index.html"><i class='bx bx-home'></i><span class="item-text ms-2">Trang
              chính</span></a></li>
        <li><a href="./Admin-AdminHome.html"><i class='bx bx-home-alt-2'></i><span
              class="item-text ms-2">Home</span></a></li>
        <li><a href="./Admin-Addproduct.html"><i class='bx bx-book-bookmark'></i><span class="item-text ms-2">Quản
              lí trang chính</span></a></li>
        <li><a href="./Admin-Feedback.html"><i class='bx bx-bar-chart'></i><span class="item-text ms-2">Đánh
              giá</span></a></li>
      </ul>
    </div>
    <div class="container-fluid ql-booking col-9 mt-5 ms-5">
      <h2 class="mb-4">Quản lí booking</h2>
      <button id="addCustomer" class="btn btn-primary mb-3">Thêm khách hàng</button>
      <div class="table-responsive scrollable">
        <table id="orderTable" class="table table-bordered tab">
          <thead class="thead-dark">
            <tr>
              <th>STT</th>
              <th>Tên khách hàng</th>
              <th>Địa chỉ</th>
              <th>Giá vé</th>
              <th style="width: 60px;">Số vé</th>
              <th>Giá tiền</th>
              <th>Check-in</th>
              <th>Check-out</th>
              <th>Sửa</th>
              <th>Xóa</th>
            </tr>
          </thead>
          <tbody id="productTable">
            <tr>
              <td>1</td>
              <td>Anh Tứng</td>
              <td>Hồ Trị An</td>
              <td class="ticket-price">380.000&nbsp;₫</td>
              <td>1</td>
              <td class="price">380.000&nbsp;₫</td>
              <td>12/06/2024 - 02:44</td>
              <td>28/06/2024 - 02:44</td>
              <td>
                <button class="btn btn-sm btn-warning" onclick="editRow(this)">Sửa</button>
              </td>
              <td>
                <button class="btn btn-sm btn-danger" onclick="removeRow(this)">Xóa</button>
              </td>
            </tr>
            <tr>
              <td>2</td>
              <td>Toàn Đẹp Trai</td>
              <td>Hồ Dầu Tiếng</td>
              <td class="ticket-price">380.000&nbsp;₫</td>
              <td>1</td>
              <td class="price">580.000&nbsp;₫</td>
              <td>12/06/2024 - 02:44</td>
              <td>28/06/2024 - 02:44</td>
              <td>
                <button class="btn btn-sm btn-warning" onclick="editRow(this)">Sửa</button>
              </td>
              <td>
                <button class="btn btn-sm btn-danger" onclick="removeRow(this)">Xóa</button>
              </td>
            </tr>
            <tr>
              <td>3</td>
              <td>Phong Luôn Giữ Bình Tĩnh</td>
              <td>Hồ Dầu Tiếng</td>
              <td class="ticket-price">580.000&nbsp;₫</td>
              <td>4</td>
              <td class="price">2.320.000&nbsp;₫</td>
              <td>12/06/2024 - 02:44</td>
              <td>28/06/2024 - 02:44</td>
              <td>
                <button class="btn btn-sm btn-warning" onclick="editRow(this)">Sửa</button>
              </td>
              <td>
                <button class="btn btn-sm btn-danger" onclick="removeRow(this)">Xóa</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div id="myModal" class="modal-qlbooking">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h4 id="modalTitle">Thêm khách hàng mới</h4>
        <form id="customerForm">
          <div class="form-group">
            <label for="customerName">Tên khách hàng</label>
            <input type="text" class="form-control" id="customerName" required>
          </div>
          <div class="form-group">
            <label for="customerAddress">Địa chỉ</label>
            <select class="form-control" id="customerAddress">
              <option value="380000">Hồ Trị An</option>
              <option value="380000">Hồ Tràm</option>
              <option value="580000">Hồ Dầu Tiếng</option>
            </select>
          </div>
          <div class="form-group">
            <label for="ticketQuantity">Số lượng vé</label>
            <input type="number" class="form-control" id="ticketQuantity" value="1" min="1" required>
          </div>
          <div class="form-group">
            <label for="checkInTime">Thời gian check-in</label>
            <input type="datetime-local" class="form-control" id="checkInTime" required>
          </div>
          <div class="form-group">
            <label for="checkOutTime">Thời gian check-out</label>
            <input type="datetime-local" class="form-control" id="checkOutTime" required>
          </div>
          <button type="submit" class="btn btn-primary">Lưu</button>
        </form>
      </div>
    </div>
  </section>
  <script>
    document.getElementById('toggle-btn').addEventListener('click', function () {
      const sidebar = document.querySelector('.sidebar');
      const content = document.querySelector('.content-main');
      sidebar.classList.toggle('open');
      sidebar.classList.toggle('closed');
      content.classList.toggle('expanded');
    });
    var toggleBtn = document.querySelector('.toggle-btn');
    var sidebar = document.querySelector('.sidebar');
    var content = document.querySelector('.content');

    toggleBtn.addEventListener('click', function () {
      sidebar.classList.toggle('closed');
      content.classList.toggle('expanded');
    });
  </script>
  <script>
    let orderCount = 3;
    let editIndex = 0;

    document.getElementById('addCustomer').addEventListener('click', () => {
      editIndex = -1;
      document.getElementById('modalTitle').innerText = 'Thêm khách hàng mới';
      document.getElementById('customerForm').reset();
      document.getElementById('myModal').style.display = "block";
    });

    document.getElementsByClassName('close')[0].onclick = function () {
      document.getElementById('myModal').style.display = "none";
    }

    window.onclick = function (event) {
      if (event.target == document.getElementById('myModal')) {
        document.getElementById('myModal').style.display = "none";
      }
    }

    document.getElementById('customerForm').addEventListener('submit', function (e) {
      e.preventDefault();

      const name = document.getElementById('customerName').value;
      const addressSelect = document.getElementById('customerAddress');
      const address = addressSelect.options[addressSelect.selectedIndex].text;
      const pricePerTicket = parseInt(addressSelect.value);
      const quantity = parseInt(document.getElementById('ticketQuantity').value);
      const checkInTime = document.getElementById('checkInTime').value;
      const checkOutTime = document.getElementById('checkOutTime').value;
      const totalPrice = pricePerTicket * quantity;

      const formattedCheckIn = formatDateTime(checkInTime);
      const formattedCheckOut = formatDateTime(checkOutTime);

      if (editIndex === -1) {
        orderCount++;
        const tbody = document.querySelector('#orderTable tbody');
        const tr = document.createElement('tr');
        tr.innerHTML = `
              <td>${orderCount}</td>
              <td>${name}</td>
              <td>${address}</td>
              <td class="ticket-price">${formatPrice(pricePerTicket)}</td>
              <td>${quantity}</td>
              <td class="price">${formatPrice(totalPrice)}</td>
              <td>${formattedCheckIn}</td>
              <td>${formattedCheckOut}</td>
              <td>
                <button class="btn btn-sm btn-warning" onclick="editRow(this)">Sửa</button>
              </td>
              <td>
                <button class="btn btn-sm btn-danger" onclick="removeRow(this)">Xóa</button>
              </td>
            `;
        tbody.appendChild(tr);
      } else {
        const row = document.querySelector(`#orderTable tbody tr:nth-child(${editIndex + 1})`);
        row.children[1].innerText = name;
        row.children[2].innerText = address;
        row.children[3].innerText = formatPrice(pricePerTicket);
        row.children[4].innerText = quantity;
        row.children[5].innerText = formatPrice(totalPrice);
        row.children[6].innerText = formattedCheckIn;
        row.children[7].innerText = formattedCheckOut;
      }

      document.getElementById('myModal').style.display = "none";
      document.getElementById('customerForm').reset();
    });

    function editRow(button) {
      editIndex = Array.prototype.indexOf.call(button.parentNode.parentNode.parentNode.children, button.parentNode.parentNode);
      const row = document.querySelector(`#orderTable tbody tr:nth-child(${editIndex + 1})`);
      document.getElementById('modalTitle').innerText = 'Sửa khách hàng';
      document.getElementById('customerName').value = row.children[1].innerText;
      const addressSelect = document.getElementById('customerAddress');
      for (let i = 0; i < addressSelect.options.length; i++) {
        if (addressSelect.options[i].text === row.children[2].innerText) {
          addressSelect.selectedIndex = i;
          break;
        }
      }
      document.getElementById('ticketQuantity').value = row.children[4].innerText;
      document.getElementById('checkInTime').value = formatDateTimeForInput(row.children[6].innerText);
      document.getElementById('checkOutTime').value = formatDateTimeForInput(row.children[7].innerText);
      document.getElementById('myModal').style.display = "block";
    }

    function removeRow(button) {
      const tr = button.closest('tr');
      tr.remove();
      orderCount--;
      updateOrderNumbers();
    }

    function updateOrderNumbers() {
      const rows = document.querySelectorAll('#orderTable tbody tr');
      rows.forEach((row, index) => {
        row.querySelector('td:first-child').textContent = index + 1;
      });
    }

    function formatPrice(value) {
      return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(value);
    }

    function formatDateTime(dateTime) {
      const date = new Date(dateTime);
      const day = String(date.getDate()).padStart(2, '0');
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const year = date.getFullYear();
      const hours = String(date.getHours()).padStart(2, '0');
      const minutes = String(date.getMinutes()).padStart(2, '0');
      return `${day}/${month}/${year} - ${hours}:${minutes}`;
    }

    function formatDateTimeForInput(dateTime) {
      const [datePart, timePart] = dateTime.split(' - ');
      const [day, month, year] = datePart.split('/');
      const [hours, minutes] = timePart.split(':');
      return `${year}-${month}-${day}T${hours}:${minutes}`;
    }
  </script>
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0/dist/chartjs-plugin-datalabels.min.js"></script>
</body>

</html>